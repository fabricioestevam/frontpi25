<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Monitor de Parada</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f5f5f5; margin: 0; padding: 0; }
    header { background: #007bff; color: #fff; padding: 20px; text-align: center; }
    main { padding: 20px; }
    h2 { margin-top: 0; }
    .info { margin-bottom: 20px; }
    .bus-list { list-style: none; padding: 0; }
    .bus-list li { background: #fff; padding: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: 0 0 5px rgba(0,0,0,0.1); }
  </style>
</head>
<body>
  <header>
    <h1 id="parada-nome">Carregando parada...</h1>
    <p id="parada-endereco"></p>
    <p id="parada-coordenadas"></p>
  </header>
  <main>
    <h2>Linhas que passam</h2>
    <ul id="linhas" class="bus-list"></ul>

    <h2>Ônibus na parada</h2>
    <ul id="onibus" class="bus-list"></ul>
  </main>

  <script>
    // Configuração das paradas
    const paradas = {
      caxanga: { nome: "TI Caxangá", endereco: "Av. Caxangá, Caxangá", coordenadas: "-8.045, -34.923", linhas: ["101", "102", "103"] },
      poeta: { nome: "BRT Engenho Poeta", endereco: "Av. Caxangá", coordenadas: "-8.050, -34.920", linhas: ["201", "202"] },
      caiara: { nome: "BRT Caiara", endereco: "Av. Caxangá", coordenadas: "-8.055, -34.915", linhas: ["301", "302"] },
      cordeiro: { nome: "BRT Parque do Cordeiro", endereco: "Av. Caxangá", coordenadas: "-8.060, -34.910", linhas: ["401", "402"] },
      getulio: { nome: "BRT Getúlio Vargas", endereco: "Av. Caxangá", coordenadas: "-8.065, -34.905", linhas: ["501", "502"] },
      derby: { nome: "BRT Derby", endereco: "Praça do Derby", coordenadas: "-8.070, -34.900", linhas: ["601", "602"] },
      hospedaria: { nome: "BRT Hospedaria", endereco: "Av. Conde da Boa Vista", coordenadas: "-8.075, -34.895", linhas: ["701", "702"] },
      "boa-vista": { nome: "BRT Shopping Boa Vista", endereco: "Av. Conde da Boa Vista", coordenadas: "-8.080, -34.890", linhas: ["801", "802"] }
    };

    // Lê o ID da parada da URL
    const urlParams = new URLSearchParams(window.location.search);
    const paradaID = urlParams.get('parada');

    if (!paradaID || !paradas[paradaID]) {
      document.getElementById('parada-nome').textContent = "Parada não encontrada";
    } else {
      const parada = paradas[paradaID];
      document.getElementById('parada-nome').textContent = parada.nome;
      document.getElementById('parada-endereco').textContent = parada.endereco;
      document.getElementById('parada-coordenadas').textContent = `Coordenadas: ${parada.coordenadas}`;

      // Exibe linhas
      const linhasList = document.getElementById('linhas');
      parada.linhas.forEach(linha => {
        const li = document.createElement('li');
        li.textContent = `Linha ${linha}`;
        linhasList.appendChild(li);
      });

      // Busca ônibus da parada no backend
      fetch('https://seu-backend.net/upload/list')
        .then(res => res.json())
        .then(data => {
          const onibusList = document.getElementById('onibus');
          // Filtra apenas os ônibus dessa parada
          const onibusParada = data.filter(o => o.parada === paradaID);
          if (onibusParada.length === 0) {
            onibusList.innerHTML = "<li>Nenhum ônibus no momento</li>";
          } else {
            onibusParada.forEach(bus => {
              const li = document.createElement('li');
              li.textContent = `Ônibus ${bus.linha} - ${bus.status || "A caminho"}`;
              onibusList.appendChild(li);
            });
          }
        })
        .catch(err => {
          console.error(err);
          document.getElementById('onibus').innerHTML = "<li>Erro ao carregar ônibus</li>";
        });
    }
  </script>
</body>
</html>
