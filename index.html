<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Monitor de Parada - PE</title>
  <style>
    /* Cores de Pernambuco */
    :root {
      --azul-pe: #00247d;
      --vermelho-pe: #d80027;
      --amarelo-pe: #ffcd00;
      --branco: #ffffff;
      --cinza-claro: #f5f5f5;
    }

    body {
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding: 0;
      background: var(--cinza-claro);
      color: #333;
    }

    header {
      background: var(--azul-pe);
      color: var(--branco);
      text-align: center;
      padding: 20px 10px;
    }

    header h1 {
      margin: 0;
      font-size: 2em;
    }

    header p {
      margin: 5px 0;
      font-size: 1em;
    }

    main {
      padding: 20px;
      max-width: 800px;
      margin: 0 auto;
    }

    h2 {
      margin-top: 30px;
      color: var(--azul-pe);
    }

    ul.bus-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    ul.bus-list li {
      background: var(--branco);
      padding: 15px 20px;
      margin-bottom: 12px;
      border-left: 8px solid var(--azul-pe);
      border-radius: 5px;
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
      font-weight: bold;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    /* Cores de status do ônibus */
    .status-a-caminho { border-left-color: #28a745; }  /* verde */
    .status-atrasado { border-left-color: #ffc107; }   /* amarelo */
    .status-parado { border-left-color: #dc3545; }     /* vermelho */
  </style>
</head>
<body>
  <header>
    <h1 id="parada-nome">Carregando parada...</h1>
    <p id="parada-endereco"></p>
  </header>
  <main>
    <h2>Linhas que passam</h2>
    <ul id="linhas" class="bus-list"></ul>

    <h2>Ônibus na parada</h2>
    <ul id="onibus" class="bus-list"></ul>
  </main>

  <script>
    const paradas = {
      caxanga: { nome: "TI Caxangá", endereco: "Av. Caxangá, Caxangá", linhas: ["101", "102", "103"] },
      poeta: { nome: "BRT Engenho Poeta", endereco: "Av. Caxangá", linhas: ["201", "202"] },
      caiara: { nome: "BRT Caiara", endereco: "Av. Caxangá", linhas: ["301", "302"] },
      cordeiro: { nome: "BRT Parque do Cordeiro", endereco: "Av. Caxangá", linhas: ["401", "402"] },
      getulio: { nome: "BRT Getúlio Vargas", endereco: "Av. Caxangá", linhas: ["501", "502"] },
      derby: { nome: "BRT Derby", endereco: "Praça do Derby", linhas: ["601", "602"] },
      hospedaria: { nome: "BRT Hospedaria", endereco: "Av. Conde da Boa Vista", linhas: ["701", "702"] },
      "boa-vista": { nome: "BRT Shopping Boa Vista", endereco: "Av. Conde da Boa Vista", linhas: ["801", "802"] }
    };

    const urlParams = new URLSearchParams(window.location.search);
    const paradaID = urlParams.get('parada');

    if (!paradaID || !paradas[paradaID]) {
      document.getElementById('parada-nome').textContent = "Parada não encontrada";
    } else {
      const parada = paradas[paradaID];
      document.getElementById('parada-nome').textContent = parada.nome;
      document.getElementById('parada-endereco').textContent = parada.endereco;

      // Exibe linhas
      const linhasList = document.getElementById('linhas');
      parada.linhas.forEach(linha => {
        const li = document.createElement('li');
        li.textContent = `Linha ${linha}`;
        linhasList.appendChild(li);
      });

      // Função para atualizar ônibus
      function atualizarOnibus() {
        fetch('https://seu-backend.net/upload/list')
          .then(res => res.json())
          .then(data => {
            const onibusList = document.getElementById('onibus');
            onibusList.innerHTML = "";

            const onibusParada = data.filter(o => o.parada === paradaID);
            if (onibusParada.length === 0) {
              onibusList.innerHTML = "<li>Nenhum ônibus no momento</li>";
            } else {
              onibusParada.forEach(bus => {
                const li = document.createElement('li');
                li.textContent = `Ônibus ${bus.linha}`;
                // Define classe de status
                if(bus.status === "A caminho") li.classList.add('status-a-caminho');
                else if(bus.status === "Atrasado") li.classList.add('status-atrasado');
                else li.classList.add('status-parado');
                onibusList.appendChild(li);
              });
            }
          })
          .catch(err => {
            console.error(err);
            document.getElementById('onibus').innerHTML = "<li>Erro ao carregar ônibus</li>";
          });
      }

      atualizarOnibus();
      setInterval(atualizarOnibus, 10000);
    }
  </script>
</body>
</html>
